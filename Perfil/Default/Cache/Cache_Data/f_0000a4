{"version":3,"file":"ui_packages_query-builder-element_query-builder-element_ts-xxxxxxxxxxxx.js","mappings":"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","sources":["ui/packages/trusted-types-policies/jtml.ts","ui/packages/jtml-shimmed/jtml-shimmed.ts","ui/packages/query-builder-element/query-builder-api.ts","ui/packages/query-builder-element/query-builder-element.ts"],"sourcesContent":["import {ghTrustedTypes} from '@github-ui/trusted-types'\nimport {trustedTypesPolicy} from './policy'\n\nconst policyName = 'jtml-no-op'\n\n// This is a temporary policy to allow us to migrate to Trusted Types without breaking existing code.\nexport const temporaryPermissiveJtmlPolicy = ghTrustedTypes.createPolicy(policyName, {\n  createHTML: (s: string) => {\n    return trustedTypesPolicy.apply({\n      policy: () => s,\n      policyName,\n      fallback: s,\n      fallbackOnError: true,\n    })\n  },\n})\n","import {temporaryPermissiveJtmlPolicy} from '@github-ui/trusted-types-policies/jtml'\n// eslint-disable-next-line no-restricted-imports\nimport {TemplateResult} from '@github/jtml'\n\n// eslint-disable-next-line no-restricted-imports\nexport {html, unsafeHTML, render} from '@github/jtml'\n\nTemplateResult.setCSPTrustedTypesPolicy(temporaryPermissiveJtmlPolicy)\nexport {TemplateResult}\n","import type {SafeHTMLString} from '@github-ui/safe-html'\n\nexport type QueryBuilderAction = URLAction | QueryAction | RewriteQueryAction | CommandAction\nexport enum SearchScopeText {\n  DIRECTORY = 'Search in this directory',\n  ORG = 'Search in this organization',\n  OWNER = 'Search in this owner',\n  REPO = 'Search in this repository',\n  GITHUB = 'Search all of GitHub',\n  GENERAL = 'Submit search',\n  COMMAND = 'Run command',\n  COPILOT = 'Ask Copilot',\n  DEFAULT = 'Jump to',\n}\n\nexport const AutocompleteText = 'Autocomplete'\n\nexport type Provider = SearchProvider | FilterProvider\n\nexport interface Parser<IntermediateRepresentation> {\n  // Note, the intermediate representation data will be available within\n  // providers on the QueryEvent as QueryEvent.parsedMetadata\n  parse(input: string, caretPosition: number | undefined): IntermediateRepresentation\n\n  // Flattens the intermediate representation into a list of QueryElements that\n  // can be styled by QueryBuilder\n  flatten(input: IntermediateRepresentation): QueryElement[]\n}\n\ninterface FilterItemData {\n  filter: string\n  value: string\n  name?: string\n  description?: string\n  inlineDescription?: boolean\n  priority?: number\n  icon?: Icon\n  avatar?: Avatar\n  action?: QueryBuilderAction\n}\n\nexport interface Avatar {\n  type: 'user' | 'org' | 'team'\n  url: string\n}\n\n/**\n * FilterItem represents a value that can be used in a filter. Some examples:\n * - filter is `repo:`, value is `github/github`\n * - filter is `author:`, value is `@keithamus`\n */\nexport class FilterItem extends Event {\n  public name: string\n  public filter: string\n  public value: string\n  public description: string\n  public inlineDescription = false\n  public action?: QueryBuilderAction\n  public priority: number\n  public icon?: Icon\n  public avatar?: Avatar\n\n  constructor({\n    filter,\n    value,\n    name = '',\n    description = '',\n    inlineDescription = false,\n    priority = Infinity,\n    icon = undefined,\n    avatar = undefined,\n    action,\n  }: FilterItemData) {\n    super('filter-item')\n    this.filter = filter\n    this.value = value\n    this.name = name\n    this.description = description\n    this.inlineDescription = inlineDescription\n    this.priority = priority\n    this.icon = icon\n    this.avatar = avatar\n    this.action = action\n  }\n}\n\n/* URLAction represents the URL a SearchItem will navigate to when enacted on */\ninterface URLAction {\n  url: string\n}\n\n/* QueryAction Represents the new Query String that a SearchItem will populate\n * the query-builder input with, when enacted on*/\ninterface QueryAction {\n  query: string\n}\n\ninterface RewriteQueryAction {\n  // Replaces the entire query with the provided string\n  replaceQueryWith: string\n  // The position in the query to move the caret to\n  moveCaretTo: number\n}\n\ninterface CommandAction {\n  commandName: string\n  data: Record<string, unknown>\n}\n\nexport interface CustomIcon {\n  html: SafeHTMLString\n}\n\nexport function isCustomIcon(icon: Icon): icon is CustomIcon {\n  return icon instanceof Object\n}\n\nexport enum Octicon {\n  Apps = 'apps',\n  Archived = 'archived',\n  Bookmark = 'bookmark',\n  Branch = 'branch',\n  Calendar = 'calendar',\n  Circle = 'circle',\n  Code = 'code',\n  Comment = 'comment',\n  Copilot = 'copilot',\n  Default = 'default',\n  Discussion = 'discussion',\n  Draft = 'draft',\n  FileIcon = 'file-icon',\n  FileCode = 'file-code',\n  Filter = 'filter',\n  Forbidden = 'forbidden',\n  History = 'history',\n  Issue = 'issue',\n  IssueClosed = 'issueClosed',\n  Iterations = 'iterations',\n  Mention = 'mention',\n  Merged = 'merged',\n  No = 'no',\n  Not = 'not',\n  Milestone = 'milestone',\n  Organization = 'organization',\n  Pencil = 'pencil',\n  Person = 'person',\n  PlusCircle = 'plus-circle',\n  Project = 'project',\n  PullRequest = 'pullRequest',\n  Reaction = 'reaction',\n  Repo = 'repo',\n  Search = 'search',\n  SingleSelect = 'single-select',\n  Sort = 'sort',\n  Tag = 'tag',\n  Team = 'team',\n  Trash = 'trash',\n  Question = 'question',\n}\n\nexport enum PrefixColor {\n  Entity = '--color-prettylights-syntax-entity',\n  Constant = '--color-prettylights-syntax-constant',\n  Keyword = '--color-prettylights-syntax-keyword',\n  Variable = '--color-prettylights-syntax-variable',\n  String = '--color-prettylights-syntax-string',\n}\n\nexport type Icon = Octicon | CustomIcon\n\ninterface SearchItemData {\n  priority: number\n  value: string\n  action: QueryBuilderAction\n  description?: string\n  icon?: Icon\n  scope?: keyof typeof SearchScopeText\n  prefixText?: string\n  prefixColor?: PrefixColor\n\n  // If set, the item will only be rendered if no other providers\n  // sent items.\n  isFallbackSuggestion?: boolean\n}\n\n/* SearchItem represents a result that appears in the results list, and has an action for a user to enact on */\nexport class SearchItem extends Event {\n  public priority: number\n  public value: string\n  public action: QueryBuilderAction\n  public description: string\n  public icon?: Icon\n  public scope: keyof typeof SearchScopeText\n  public prefixText?: string\n  public prefixColor?: PrefixColor\n  public isFallbackSuggestion: boolean\n\n  constructor({\n    priority,\n    value,\n    action,\n    description = '',\n    icon = undefined,\n    scope = 'DEFAULT',\n    prefixText,\n    prefixColor,\n    isFallbackSuggestion,\n  }: SearchItemData) {\n    super('search-item')\n    this.priority = priority\n    this.value = value\n    this.prefixText = prefixText\n    this.prefixColor = prefixColor\n    this.action = action\n    this.description = description\n    this.icon = icon\n    this.scope = scope\n    this.isFallbackSuggestion = isFallbackSuggestion || false\n  }\n}\n\nexport interface SearchProvider extends EventTarget {\n  priority: number\n  icon?: Icon\n  name: string // plural group name (i.e. \"repositories\" or \"teams\") - will be the visual header\n  description?: string\n  singularItemName: string // singular name for an item (i.e. \"repository\" or \"team\") to construct a meaningful aria-label, doesn't appear visually\n  value: string // visual name of the filter (i.e. \"is:\")\n  type: 'search'\n}\n\nexport interface FilterProvider extends EventTarget {\n  priority: number\n  icon?: Icon\n  name: string // plural group name (i.e. \"repositories\" or \"teams\") - will be the visual header\n  description?: string\n  singularItemName: string // singular name for an item (i.e. \"repository\" or \"team\") to construct a meaningful aria-label, doesn't appear visually\n  value: string // visual name of the filter (i.e. \"is:\")\n  type: 'filter'\n  // When set, if a filter provider emits filter items, always render them in the UI. If not set,\n  // filter items will only be rendered if the querybuilder thinks a filter item is being written\n  // by the user, which may be incorrect if using a custom parser.\n  manuallyDetermineFilterEligibility?: boolean\n}\n\nexport type QueryElement = QueryFilterElement | QueryTextElement\n\nexport interface QueryFilterElement {\n  type: 'filter'\n  filter: string\n  value: string\n  style?: TextElementStyle\n}\n\nexport interface QueryTextElement {\n  type: 'text'\n  value: string\n  style?: TextElementStyle\n}\n\nexport enum TextElementStyle {\n  Normal = 'normal',\n  Entity = 'entity',\n  Constant = 'constant',\n  FilterValue = 'filter-value',\n}\n\nexport class FetchDataEvent extends Event {\n  constructor(public fetchPromise: Promise<unknown>) {\n    super('fetch-data')\n  }\n}\n\nexport class QueryEvent extends Event {\n  constructor(\n    public parsedQuery: QueryElement[],\n    public rawQuery: string,\n    public parsedMetadata: unknown,\n  ) {\n    super('query')\n  }\n\n  override toString() {\n    return this.rawQuery\n  }\n}\n\nclass QueryBuilderProvider extends Event {\n  constructor(public provider: SearchProvider) {\n    super('query-builder-provider', {bubbles: true})\n  }\n}\n\ndeclare global {\n  interface Document {\n    addEventListener(type: 'query-builder-provider', handler: (event: QueryBuilderProvider) => void): void\n  }\n}\n","import {controller, attr, findTarget} from '@github/catalyst'\nimport Combobox from '@github/combobox-nav'\nimport {html, render} from '@github-ui/jtml-shimmed'\nimport type {TemplateResult} from '@github-ui/jtml-shimmed'\nimport {\n  QueryEvent,\n  type Provider,\n  type Parser,\n  type SearchItem,\n  type FilterItem,\n  SearchScopeText,\n  AutocompleteText,\n  type FetchDataEvent,\n  type Avatar,\n  type FilterProvider,\n  type Icon,\n  type QueryElement,\n  type SearchProvider,\n  isCustomIcon,\n  TextElementStyle,\n} from './query-builder-api'\n\nclass FeedbackEvent extends Event {\n  constructor(\n    public key: string,\n    public text: string,\n    public data: Record<string, unknown>,\n  ) {\n    super('query-builder-feedback', {bubbles: true, cancelable: true})\n    this.key = key\n    this.text = text\n    this.data = data\n  }\n}\n\ninterface LocalizedScreenReaderText {\n  suggestion: string\n  suggestions: string\n  clear_search: string\n}\n\n// Sorts by priority number; the lower the number, the higher it will appear in the list\nconst sortByPriority = (a: FilterProvider | SearchItem | FilterItem, b: FilterProvider | SearchItem | FilterItem) =>\n  a.priority - b.priority\n\n@controller\nexport class QueryBuilderElement extends HTMLElement {\n  #combobox?: Combobox\n  #interactingWithList = false\n  #isCleared = false\n  #providers: Record<string, Provider> = {}\n  #filterNames: Set<string> = new Set()\n  #abortController: AbortController | null = null\n  #parseAbortController: AbortController | null = null\n  #searchItems: Map<SearchProvider, SearchItem[]> = new Map()\n  #searchItemsFetchBuffer: Map<SearchProvider, SearchItem[]> = new Map()\n  #searchItemsMarkedForClearing: Set<SearchProvider> = new Set()\n  #filters: Set<FilterProvider> = new Set()\n  #filterItems: Map<FilterProvider, FilterItem[]> = new Map()\n  #uniqueId: string | null\n  #focusClass = 'QueryBuilder-focus'\n  #inputCache = new Map<string, QueryElement[]>()\n  #SCREEN_READER_DELAY = 150\n  #fetchDataTimeout = 3000\n  #fetchingResults: Promise<unknown> | false = false\n  #canAttachProviders = false\n  #requested = false\n  parser: Parser<unknown> = {\n    parse: this.#defaultParser.bind(this),\n    flatten: (ast: QueryElement[]) => ast,\n  }\n  parsedMetadata: unknown = undefined\n  renderSingularItemNames = false\n  #usingCustomParser = false\n  lastParsedQuery: string | undefined = undefined\n\n  @attr filterKey: string\n\n  /** the overlaying input where the user will type, but doesn't style the text */\n  get input(): HTMLInputElement {\n    return findTarget(this, 'input') as HTMLInputElement\n  }\n  /** contains the styled input content that the user can see */\n  get styledInputContent(): HTMLElement {\n    return findTarget(this, 'styledInputContent') as HTMLElement\n  }\n  /** the element that scrolls with the styled input content */\n  get styledInputContainer(): HTMLDivElement {\n    return findTarget(this, 'styledInputContainer') as HTMLDivElement\n  }\n  get styledInput(): HTMLElement {\n    return findTarget(this, 'styledInput') as HTMLElement\n  }\n  get overlay(): HTMLElement {\n    return findTarget(this, 'overlay') as HTMLElement\n  }\n  /** this sizer is invisible and contains the same text as the input; we measure it's width to set the width of the visually styled input */\n  get sizer(): HTMLElement {\n    return findTarget(this, 'sizer') as HTMLElement\n  }\n  get clearButton(): HTMLButtonElement {\n    return findTarget(this, 'clearButton') as HTMLButtonElement\n  }\n  get resultsList(): HTMLUListElement {\n    return findTarget(this, 'resultsList') as HTMLUListElement\n  }\n  get screenReaderFeedback(): HTMLElement {\n    return findTarget(this, 'screenReaderFeedback') as HTMLElement\n  }\n\n  get query() {\n    return this.input.value\n  }\n\n  get i18n(): LocalizedScreenReaderText {\n    return {\n      suggestion: 'suggestion',\n      suggestions: 'suggestions',\n      clear_search: 'Input cleared.',\n    }\n  }\n\n  // This navigate callback is used to signal that a user has clicked on a URL.\n  // We need this in code view to intercept line hash navigations (i.e. #L123)\n  // within the same file.\n  navigate(event: Event) {\n    const url = (event?.target as HTMLElement)?.closest('a')?.getAttribute('href')\n    if (url) {\n      this.dispatchEvent(new CustomEvent('query-builder:navigate', {bubbles: true, detail: {url}}))\n    }\n  }\n\n  get closed() {\n    return this.overlay && this.overlay.hasAttribute('hidden')\n  }\n\n  set closed(value: boolean) {\n    if (value) {\n      if (this.closed) return\n\n      if (this.overlay) {\n        this.overlay.hidden = true\n      }\n\n      this.input.setAttribute('aria-expanded', 'false')\n\n      this.#combobox?.clearSelection()\n    } else {\n      if (!this.closed) return\n\n      if (this.overlay) {\n        this.overlay.hidden = false\n      }\n      this.input.setAttribute('aria-expanded', 'true')\n    }\n  }\n\n  show() {\n    this.closed = false\n    this.overlay?.scrollIntoView?.({behavior: 'smooth', block: 'nearest'})\n  }\n\n  hide() {\n    if (this.resultsList.getAttribute('data-persist-list') === 'false') {\n      this.closed = true\n    }\n  }\n\n  initialize(parser: Parser<unknown>, providers: Provider[]) {\n    this.parser = parser\n    this.#usingCustomParser = true\n    this.#canAttachProviders = true\n    for (const provider of providers) {\n      this.attachProvider(provider)\n    }\n    this.#canAttachProviders = false\n    this.#providers = providers.reduce((rest, provider) => {\n      return {\n        ...rest,\n        [provider.value]: provider,\n      }\n    }, {})\n  }\n\n  elementDefinitionReadyForProviders = (e: Event) => {\n    const event = e as CustomEvent<{id: string}>\n    if (event.detail.id === this.#uniqueId) {\n      this.readyForRequestProviders()\n      e.stopImmediatePropagation()\n    }\n  }\n\n  detachElementDefinitionReadyForProviders() {\n    this.removeEventListener('query-builder:ready-to-request-provider', this.elementDefinitionReadyForProviders)\n  }\n\n  connectedCallback() {\n    this.#abortController?.abort()\n    const {signal} = (this.#abortController = new AbortController())\n    signal.addEventListener('abort', () => {\n      this.#providers = {}\n    })\n    this.#uniqueId = this.input.getAttribute('id')\n\n    if (!this.hasAttribute('defer-request-providers')) {\n      document.addEventListener(\n        'query-builder:ready-to-request-provider',\n        this.elementDefinitionReadyForProviders,\n        true,\n      )\n      this.readyForRequestProviders()\n    }\n  }\n\n  readyForRequestProviders() {\n    if (this.#providerCount() > 0 && this.#requested) return\n    this.#combobox ||= new Combobox(this.input, this.resultsList, {\n      tabInsertsSuggestions: false,\n    })\n    this.requestProviders()\n  }\n\n  async requestProviders() {\n    this.#requested = true\n    await Promise.resolve()\n\n    this.#canAttachProviders = true\n    this.dispatchEvent(new Event('query-builder:request-provider', {bubbles: true}))\n    this.#canAttachProviders = false\n\n    // Existing text may match new providers, so clear cache to ensure that\n    // the styling is correct.\n    this.#inputCache = new Map<string, QueryElement[]>()\n    const elements = this.parseInputValue()\n    this.styleInputText(elements)\n    this.toggleClearButtonVisibility()\n  }\n\n  // This function parse the current input value and cache the resulting parsed metadata. To\n  // parse values other than the input's value, directly use this.parser.\n  parseInputValue(): QueryElement[] {\n    this.parsedMetadata = this.parser.parse(this.input.value, this.input.selectionStart || 0)\n    return this.parser.flatten(this.parsedMetadata)\n  }\n\n  attachProvider(provider: Provider) {\n    if (!this.#abortController) return\n    const {signal} = this.#abortController\n\n    if (!this.#canAttachProviders) {\n      throw new Error(\"Can't attach providers after the query builder has been connected\")\n    }\n    if (this.#providers[provider.value]) return\n\n    this.#providers[provider.value] = provider\n\n    if (provider.type === 'filter') {\n      this.#filterNames.add(provider.value)\n\n      provider.addEventListener(\n        'filter-item',\n        filterItemEvent => {\n          this.#setProvider(this.#filterItems, provider)\n          this.#filterItems.get(provider)?.push(filterItemEvent as FilterItem)\n          this.#requestUpdate()\n        },\n        {signal},\n      )\n\n      // Determines when to show/hide filters based on the event in the providers\n      provider.addEventListener(\n        'show',\n        () => {\n          this.#filters.add(provider)\n          this.#requestUpdate()\n        },\n        {signal},\n      )\n\n      provider.addEventListener(\n        'fetch-data',\n        async event => {\n          const timeout = new Promise(resolve => setTimeout(resolve, this.#fetchDataTimeout))\n          const fetchDataEvent = event as FetchDataEvent\n\n          this.#fetchingResults = Promise.race([\n            Promise.all([this.#fetchingResults, fetchDataEvent.fetchPromise]),\n            timeout,\n          ])\n\n          const currentPromise = this.#fetchingResults\n\n          try {\n            await currentPromise\n          } catch (error) {\n            // @ts-expect-error catch blocks are bound to `unknown` so we need to validate the type before using it\n            if (error.name !== 'AbortError') {\n              this.#fetchingResults = false\n              throw error\n            }\n          }\n\n          // If the Promise hasn't changed, we're at the last resolution\n          if (currentPromise === this.#fetchingResults) {\n            this.#fetchingResults = false\n            this.#requestUpdate()\n\n            this.updateVisibility()\n          }\n        },\n        {signal},\n      )\n    } else {\n      provider.addEventListener('fetch-data', async event => {\n        const fetchDataEvent = event as FetchDataEvent\n        // Indicate that we will clear the search items ourselves once we resolve the promise\n        this.#searchItemsMarkedForClearing.delete(provider)\n\n        // Wait until the data is fetched\n        await fetchDataEvent.fetchPromise\n\n        this.#searchItems.set(provider, this.#searchItemsFetchBuffer.get(provider) || [])\n        this.#searchItemsFetchBuffer.delete(provider)\n        this.#requestUpdate()\n      })\n      provider.addEventListener(\n        'search-item',\n        searchItemEvent => {\n          this.#setProvider(this.#searchItems, provider)\n          if (this.#searchItemsFetchBuffer.has(provider)) {\n            this.#searchItemsFetchBuffer.get(provider)?.push(searchItemEvent as SearchItem)\n          } else {\n            if (this.#searchItemsMarkedForClearing.has(provider)) {\n              this.#searchItems.set(provider, [])\n              this.#searchItemsMarkedForClearing.delete(provider)\n            }\n\n            this.#searchItems.get(provider)?.push(searchItemEvent as SearchItem)\n            this.#requestUpdate()\n          }\n        },\n        {signal},\n      )\n    }\n  }\n\n  disconnectedCallback() {\n    this.#abortController?.abort()\n  }\n\n  comboboxCommit(event: Event) {\n    const selectedItem = event.target as HTMLLIElement\n    const selectedItemType = selectedItem?.getAttribute('data-type')\n    const selectedItemValue = selectedItem?.getAttribute('data-value') || ''\n    const replaceQueryWith = selectedItem?.getAttribute('data-replace-query-with') || ''\n    const moveCaretTo = parseInt(selectedItem?.getAttribute('data-move-caret-to') || '0') || 0\n    let elements: QueryElement[] | undefined = this.parseInputValue()\n\n    if (selectedItemType === 'url-result') {\n      // these are handled by having a link that the user clicks and the navigation happens without javascript intervention\n      // keyboard navigation to links is handled in inputKeydown\n    } else if (selectedItemType === 'filter-result') {\n      // if a filter is chosen, replace the last query element with a new Filter Element\n      elements.pop()\n      elements.push({\n        type: 'filter',\n        filter: selectedItemValue,\n        value: '',\n      })\n    } else if (selectedItemType === 'command-result') {\n      const customEventName = selectedItem.getAttribute('data-command-name') || ''\n      const data = JSON.parse(selectedItem.getAttribute('data-command-payload') || '{}')\n      this.dispatchEvent(new CustomEvent(customEventName, {detail: data}))\n    } else if (selectedItemType === 'query-result') {\n      // For manually replacing the query from the suggestion, directly manipulate\n      // the query/caret position\n      if (replaceQueryWith) {\n        this.input.value = replaceQueryWith\n        this.input.focus()\n\n        // Unsetting the elements forces `parseQuery` to re-parse from the input string\n        elements = undefined\n      } else {\n        const newElements = this.parser.flatten(this.parser.parse(selectedItemValue, 0))\n        elements.push(...newElements)\n        elements.push({type: 'text', value: ''})\n      }\n    } else if (selectedItemType === 'filter-item') {\n      // If we manually updated the query, we must also manually update the caret position\n      if (replaceQueryWith) {\n        this.input.value = replaceQueryWith\n        this.input.focus()\n\n        // Unsetting the elements forces `parseQuery` to re-parse from the input string\n        elements = undefined\n      } else {\n        this.addSelectedItemToFilter(selectedItemValue, elements)\n      }\n    }\n    this.parseQuery(elements)\n\n    // If we manually updated the query, we must also manually update the caret position\n    if (replaceQueryWith) {\n      const pos = moveCaretTo === -1 ? this.input.value.length : moveCaretTo\n      this.input.setSelectionRange(pos, pos)\n    }\n    this.input.removeAttribute('aria-activedescendant')\n  }\n\n  addSelectedItemToFilter(selectedItemValue: string, elements: QueryElement[]) {\n    const valueContainsSpaces = /\\s/.test(selectedItemValue)\n    const filter = elements.pop()\n    if (filter?.type === 'filter') {\n      // If the filter already has a value and is separated by a comma, instead of a full replace\n      // we want to append.\n      // is:pub -> is:public\n      // is:public,pri -> is:public,private\n      const filterValues = filter.value.split(',')\n      filterValues.pop()\n      filterValues.push(valueContainsSpaces ? `\"${selectedItemValue}\"` : selectedItemValue)\n\n      elements.push({\n        type: 'filter',\n        filter: filter?.filter,\n        value: filterValues.join(','),\n      })\n      elements.push({type: 'text', value: ''})\n    } else if (filter) {\n      elements.push(filter)\n    }\n  }\n\n  async inputChange() {\n    await this.parseQuery()\n  }\n\n  inputBlur() {\n    if (this.#interactingWithList) {\n      this.#interactingWithList = false\n      return\n    }\n    this.styledInput.classList.remove(this.#focusClass)\n    this.input.removeAttribute('aria-activedescendant')\n    this.hide()\n  }\n\n  resultsMousedown() {\n    this.#interactingWithList = true\n  }\n\n  async inputFocus() {\n    this.styledInput.classList.add(this.#focusClass)\n    this.readyForRequestProviders()\n    this.#combobox!.start()\n    const initialValue = this.input.value\n\n    // Don't needlessly reparse the query on focus\n    if (!this.lastParsedQuery || this.lastParsedQuery !== this.input.value) {\n      await this.parseQuery()\n    }\n\n    if (this.closed && this.input.value === initialValue) {\n      this.input.setSelectionRange(0, this.input.value.length)\n    }\n    this.input.focus()\n  }\n\n  moveCaretToEndOfInput() {\n    this.input.setSelectionRange(this.input.value.length, this.input.value.length)\n  }\n\n  hasFocus() {\n    return this.styledInput.classList.contains(this.#focusClass)\n  }\n\n  inputKeydown(event: KeyboardEvent) {\n    // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n    const key = event.key\n\n    if (key === 'Escape') {\n      this.hide()\n    } else if (key === 'Enter') {\n      const selected = this.resultsList.querySelector<HTMLElement>(\n        '[aria-selected=\"true\"], [data-combobox-option-default=\"true\"]',\n      )\n      if (!selected || selected.getAttribute('aria-disabled') === 'true') return\n      const link = selected.querySelector('a')\n      if (link) {\n        // eslint-disable-next-line @github-ui/ui-commands/no-manual-shortcut-logic\n        const openInNewWindow = event.ctrlKey || event.metaKey\n        if (openInNewWindow) {\n          window.open(link.getAttribute('href') || '', '_blank')\n        } else {\n          link.click()\n        }\n      }\n    }\n  }\n\n  inputSubmit(): void {\n    this.hide()\n  }\n\n  clearButtonFocus(event: FocusEvent) {\n    const previousFocusTarget = event.relatedTarget\n    if (!previousFocusTarget) return\n\n    // If we were previously focused on the input, we should continue to show the results list\n    if (previousFocusTarget === this.input) this.show()\n  }\n\n  clearButtonBlur() {\n    this.hide()\n  }\n\n  toggleClearButtonVisibility() {\n    if (!this.clearButton) return\n\n    if (this.input.value !== '') {\n      if (this.clearButton.hidden === false) return\n\n      this.clearButton.hidden = false\n    } else {\n      this.clearButton.hidden = true\n    }\n  }\n\n  updateVisibility() {\n    if (!this.hasFocus()) {\n      return\n    }\n\n    if (this.#filterItems.size > 0 || this.#searchItems.size > 0 || this.#filters.size > 0) {\n      this.show()\n    } else if (!this.#fetchingResults) {\n      this.hide()\n    }\n  }\n\n  #setProvider = (map: Map<Provider, SearchItem[] | FilterItem[]>, provider: Provider) => {\n    if (!map.has(provider)) {\n      map.set(provider, [])\n    }\n  }\n\n  #updateRequested = false\n\n  #requestUpdate() {\n    if (this.#updateRequested) return\n\n    this.#updateRequested = true\n    this.toggleClearButtonVisibility()\n    this.#updateRequested = false\n    this.#updateResults()\n  }\n\n  #renderFilters() {\n    if (this.#filters.size === 0) return\n\n    return html`<li role=\"presentation\" class=\"ActionList-sectionDivider\">\n      <h3 role=\"presentation\" class=\"ActionList-sectionDivider-title p-2 text-left\" aria-hidden=\"true\">\n        Suggested filters\n      </h3>\n      <ul role=\"presentation\">\n        ${[...this.#filters].sort(sortByPriority).map(filter => this.#renderFilter(filter))}\n      </ul>\n    </li>`\n  }\n\n  #renderGroup(provider: Provider, shouldRenderFallbackItems = false) {\n    let items: TemplateResult[] = []\n    const lastItem = this.parseInputValue().at(-1)!\n\n    if (provider.type === 'filter') {\n      if (provider.manuallyDetermineFilterEligibility) {\n        items =\n          this.#filterItems\n            .get(provider)\n            ?.sort(sortByPriority)\n            .map(item => this.#renderFilterItem(item)) || []\n      } else if (lastItem?.type === 'filter') {\n        items =\n          this.#filterItems\n            .get(provider)\n            ?.filter(item => item.filter === lastItem.filter)\n            .sort(sortByPriority)\n            .map(item => this.#renderFilterItem(item)) || []\n      }\n    } else {\n      const searchItems = this.#searchItems.get(provider) || []\n\n      items = [...searchItems]\n        .filter(s => s.isFallbackSuggestion === shouldRenderFallbackItems)\n        .sort(sortByPriority)\n        .map(p => this.#renderSearchItem(p))\n    }\n\n    if (!items.length) return undefined\n\n    if (provider.name === '') {\n      return html`<li role=\"presentation\" class=\"ActionList-sectionDivider\">\n        <ul role=\"presentation\">\n          ${items}\n        </ul>\n      </li>`\n    } else {\n      return html`<li role=\"presentation\" class=\"ActionList-sectionDivider\">\n        <h3\n          role=\"presentation\"\n          class=\"ActionList-sectionDivider-title QueryBuilder-sectionTitle p-2 text-left\"\n          aria-hidden=\"true\"\n        >\n          ${provider.name}\n        </h3>\n        <ul role=\"presentation\">\n          ${items}\n        </ul>\n      </li>`\n    }\n  }\n\n  #updateResults() {\n    let groupsAsHtml = Object.values(this.#providers)\n      .sort((a, b) => a.priority - b.priority)\n      .map(p => this.#renderGroup(p))\n      .filter(p => p !== undefined)\n\n    // If no suggestions are sent back from any provider, we want to show the fallback suggestion\n    if (!this.#fetchingResults && groupsAsHtml.length === 0) {\n      groupsAsHtml = Object.values(this.#providers)\n        .sort((a, b) => a.priority - b.priority)\n        .map(p => this.#renderGroup(p, true))\n        .filter(p => p !== undefined)\n    }\n\n    const filtersAsHtml = this.#renderFilters()\n    if (filtersAsHtml) groupsAsHtml.push(filtersAsHtml)\n\n    if (groupsAsHtml.length === 0) {\n      if (this.#fetchingResults) {\n        // TODO Add a loading state\n        // render(html`Loading...`, this.resultsList)\n      } else {\n        // Clear the list HTML first, otherwise the empty string will be appended to what exists\n        this.resultsList.textContent = ''\n        render(html``, this.resultsList)\n      }\n    } else {\n      render(\n        html`${groupsAsHtml.map((groupHtml, index) =>\n          index === groupsAsHtml.length - 1\n            ? groupHtml\n            : html`${groupHtml}\n                <li aria-hidden=\"true\" class=\"ActionList-sectionDivider\"></li>`,\n        )}`,\n        this.resultsList,\n      )\n    }\n\n    const numberOfResults = this.resultsList.querySelectorAll('[role=\"option\"]').length\n    let screenReaderText: string\n\n    const resultText = numberOfResults === 1 ? this.i18n.suggestion : this.i18n.suggestions\n    screenReaderText = `${numberOfResults} ${resultText}.`\n\n    if (this.#isCleared) {\n      screenReaderText = `${this.i18n.clear_search} ${screenReaderText}`\n      this.#isCleared = false\n    }\n\n    /** This is a hack due to the way the aria live API works.\n        A screen reader will not read a live region again\n        if the text is the same. Adding a space character tells\n        the browser that the live region has updated,\n        which will cause it to read again, but with no audible difference. */\n    if (this.screenReaderFeedback.textContent === screenReaderText) {\n      screenReaderText += '\\u00A0'\n    }\n    // Adds a delay so that focus moving back to the input is read before the amount of suggestions.\n    setTimeout(() => this.updateScreenReaderFeedback(screenReaderText), this.#SCREEN_READER_DELAY)\n  }\n\n  #normalizeValue(value: string) {\n    if (!value) return\n\n    return value.replace(/\\s/g, '-').toLowerCase()\n  }\n\n  getLeadingVisual(icon: Icon, avatar?: Avatar) {\n    if (avatar) {\n      const classes = avatar.type === 'org' ? 'avatar avatar-1 avatar-small' : 'avatar avatar-1 avatar-small circle'\n      return html`<img src=\"${avatar.url}\" alt=\"\" role=\"presentation\" class=\"${classes}\" />`\n    }\n\n    if (icon && isCustomIcon(icon)) {\n      return html([icon.html] as unknown as TemplateStringsArray)\n    }\n\n    const iconElement = document.getElementById(`${icon}-icon`) as HTMLTemplateElement\n    return html([iconElement?.innerHTML] as unknown as TemplateStringsArray)\n  }\n\n  // Item that will take you somewhere when chosen (i.e. a link to a repository or a search result)\n  #renderSearchItem({value, prefixText, prefixColor, target: provider, action, description, icon, scope}: SearchItem) {\n    if ('url' in action) {\n      const ariaLabelAction =\n        scope === 'GENERAL'\n          ? `${SearchScopeText[scope]}`\n          : `jump to this ${(provider as SearchProvider).singularItemName}`\n      const ariaLabelDescription = description ? `, ${description}` : ''\n      const ariaLabel = `${prefixText ? `${prefixText} ` : ''}${value}${ariaLabelDescription}, ${ariaLabelAction}`\n\n      let prefixHTML = null\n      if (prefixText) {\n        prefixHTML = html`\n          <span>\n            <div class=\"d-inline-flex position-relative\">\n              <div\n                class=\"position-absolute rounded-1 flex-items-stretch height-full width-full\"\n                style=\"opacity: 0.1; background-color: var(${prefixColor})\"\n              ></div>\n              <div class=\"px-1\" style=\"color: var(${prefixColor})\">${prefixText}</div>\n            </div>\n            ${this.#styleResults(value)}\n          </span>\n        `\n      }\n\n      return html`<li\n        role=\"option\"\n        class=\"ActionListItem\"\n        data-type=\"url-result\"\n        id=\"${this.#uniqueId || 'search-item'}-result-${this.#normalizeValue(value)}\"\n        data-value=\"${value}\"\n        aria-label=\"${ariaLabel}\"\n      >\n        <a\n          href=\"${action.url}\"\n          data-action=\"click:query-builder#navigate\"\n          tabindex=\"-1\"\n          class=\"QueryBuilder-ListItem-link ActionListContent ActionListContent--visual16 QueryBuilder-ListItem\"\n        >\n          ${icon\n            ? html`<span\n                id=\"${this.#uniqueId || 'search-item'}-result-${this.#normalizeValue(value)}--leading\"\n                class=\"ActionListItem-visual ActionListItem-visual--leading\"\n              >\n                ${this.getLeadingVisual(icon)}\n              </span>`\n            : null}\n          <span class=\"ActionListItem-descriptionWrap\">\n            <span class=\"ActionListItem-label text-normal\"> ${prefixHTML || this.#styleResults(value)} </span>\n            ${description ? html`<span class=\"ActionListItem-description\">${description}</span>` : null}\n          </span>\n\n          <span aria-hidden=\"true\" class=\"ActionListItem-description QueryBuilder-ListItem-trailing\"\n            >${SearchScopeText[scope]}</span\n          >\n        </a>\n      </li>`\n    } else if ('commandName' in action) {\n      const ariaLabelAction = SearchScopeText[scope] || SearchScopeText['COMMAND']\n      const ariaLabelDescription = description ? `, ${description}` : ''\n      const ariaLabel = `${value}${ariaLabelDescription}, ${ariaLabelAction}`\n\n      return html`<li\n        role=\"option\"\n        class=\"ActionListItem\"\n        data-type=\"command-result\"\n        id=\"${this.#uniqueId || 'search-item'}-result-${this.#normalizeValue(value)}\"\n        data-value=\"${value}\"\n        data-command-name=\"${action.commandName}\"\n        data-command-payload=\"${JSON.stringify(action.data)}\"\n        aria-label=\"${ariaLabel}\"\n      >\n        <span class=\"ActionListContent ActionListContent--visual16 QueryBuilder-ListItem\">\n          ${icon\n            ? html`<span\n                id=\"${this.#uniqueId || 'search-item'}-result-${this.#normalizeValue(value)}--leading\"\n                class=\"ActionListItem-visual ActionListItem-visual--leading\"\n              >\n                ${this.getLeadingVisual(icon)}\n              </span>`\n            : null}\n          <span class=\"ActionListItem-descriptionWrap\">\n            <span class=\"ActionListItem-label text-normal\"> ${this.#styleResults(value)} </span>\n            ${description ? html`<span class=\"ActionListItem-description\">${description}</span>` : null}\n          </span>\n\n          <span aria-hidden=\"true\" class=\"ActionListItem-description QueryBuilder-ListItem-trailing\"\n            >${ariaLabelAction}</span\n          >\n        </span>\n      </li>`\n    } else {\n      let replaceQueryWith = ''\n      let moveCaretTo = 0\n      if ('replaceQueryWith' in action) {\n        replaceQueryWith = action.replaceQueryWith\n        moveCaretTo = action.moveCaretTo\n      }\n\n      const scopeText = 'query' in action ? SearchScopeText[scope] : AutocompleteText\n\n      return html` <li\n        role=\"option\"\n        class=\"ActionListItem\"\n        data-type=\"query-result\"\n        data-value=\"${value}\"\n        aria-label=\"${value}${description ? `, ${description}` : ''}\"\n        data-replace-query-with=\"${replaceQueryWith}\"\n        data-move-caret-to=\"${moveCaretTo}\"\n        id=\"${this.#uniqueId || 'search-item'}-result-${this.#normalizeValue(value)}\"\n      >\n        <span class=\"ActionListContent ActionListContent--visual16 QueryBuilder-ListItem\">\n          ${icon\n            ? html`<span\n                id=\"${this.#uniqueId || 'search-item'}-result-${this.#normalizeValue(value)}--leading\"\n                class=\"ActionListItem-visual ActionListItem-visual--leading\"\n              >\n                ${this.getLeadingVisual(icon)}\n              </span>`\n            : null}\n          <span class=\"ActionListItem-descriptionWrap\">\n            <span class=\"ActionListItem-label text-normal\">${this.#styleResults(value)}</span>\n            ${description ? html`<span class=\"ActionListItem-description\">${description}</span>` : null}\n          </span>\n\n          ${this.#searchItems.size > 0\n            ? html`<span aria-hidden=\"true\" class=\"ActionListItem-description QueryBuilder-ListItem-trailing\"\n                >${scopeText}</span\n              >`\n            : html``}\n        </span>\n      </li>`\n    }\n  }\n\n  #styleResults(query: string) {\n    const inputArray = this.parser.flatten(this.parser.parse(query, 0))\n    const shouldAddTrailingSpace = !this.#usingCustomParser\n\n    const out: TemplateResult[] = []\n    for (const group of inputArray) {\n      if (group.type === 'filter') {\n        out.push(\n          html`<span>${group.filter}:</span\n            ><span data-type=\"filter-value\">${group.value}${shouldAddTrailingSpace ? ' ' : ''}</span>`,\n        )\n      } else {\n        let style = ''\n        if (group.style === TextElementStyle.Constant) {\n          style = 'qb-constant'\n        } else if (group.style === TextElementStyle.Entity) {\n          style = 'qb-entity'\n        } else if (group.style === TextElementStyle.FilterValue) {\n          style = 'qb-filter-value'\n        }\n        out.push(html`<span class=\"${style}\">${group.value}${shouldAddTrailingSpace ? ' ' : ''}</span>`)\n      }\n    }\n\n    return out\n  }\n\n  // Keeping these as separate templates in order to\n  // make it easier in the future if these need to diverge more.\n  // Renders a filter item (i.e. 'repo' or 'project')\n  #renderFilter({singularItemName, icon, description, value}: FilterProvider) {\n    const ariaLabelDescription = description ? `, ${description}` : ''\n    const ariaLabel = `${this.renderSingularItemNames ? singularItemName : value}${ariaLabelDescription}`\n\n    return html` <li\n      role=\"option\"\n      class=\"ActionListItem\"\n      data-type=\"filter-result\"\n      data-value=\"${value}\"\n      id=\"${this.#uniqueId || 'filter'}-result-${this.#normalizeValue(value)}\"\n      aria-label=\"${ariaLabel}, filter\"\n    >\n      <span class=\"ActionListContent ActionListContent--visual16 QueryBuilder-ListItem\">\n        ${icon\n          ? html`<span\n              id=\"${this.#uniqueId || 'filter'}-result-${this.#normalizeValue(value)}--leading\"\n              class=\"ActionListItem-visual ActionListItem-visual--leading\"\n            >\n              ${this.getLeadingVisual(icon)}\n            </span>`\n          : null}\n        <span class=\"ActionListItem-descriptionWrap\">\n          <span class=\"ActionListItem-label text-normal\">\n            ${this.renderSingularItemNames ? singularItemName : `${value}:`}\n          </span>\n          ${description ? html`<span class=\"ActionListItem-description\">${description}</span>` : null}\n        </span>\n\n        ${this.#searchItems.size > 0\n          ? html`<span aria-hidden=\"true\" class=\"ActionListItem-description QueryBuilder-ListItem-trailing\"\n              >${AutocompleteText}</span\n            >`\n          : html``}\n      </span>\n    </li>`\n  }\n\n  // Renders a filter value that is appended to the input (i.e. 'github/github')\n  #renderFilterItem({name, value, target: provider, icon, avatar, description, inlineDescription, action}: FilterItem) {\n    const valueToShow = name && name.length > 0 ? name : value\n    const ariaLabelDescription = description ? `, ${description}` : ''\n    const ariaLabel = (provider as Provider).singularItemName\n      ? `${valueToShow}${ariaLabelDescription}, autocomplete this ${(provider as Provider).singularItemName}`\n      : `${valueToShow}${ariaLabelDescription}, ${(provider as Provider).name}`\n\n    let replaceQueryWith = ''\n    let moveCaretTo = 0\n    if (action && 'replaceQueryWith' in action) {\n      replaceQueryWith = action.replaceQueryWith\n      moveCaretTo = action.moveCaretTo\n    }\n\n    return html` <li\n      role=\"option\"\n      class=\"ActionListItem\"\n      data-type=\"filter-item\"\n      data-replace-query-with=\"${replaceQueryWith}\"\n      data-move-caret-to=\"${moveCaretTo}\"\n      data-value=\"${value}\"\n      id=\"${this.#uniqueId || 'filter-item'}-result-${this.#normalizeValue(value)}\"\n      aria-label=\"${ariaLabel}\"\n    >\n      <span class=\"ActionListContent ActionListContent--visual16 QueryBuilder-ListItem\">\n        ${icon\n          ? html`<span\n              id=\"${this.#uniqueId || 'filter-item'}-result-${this.#normalizeValue(value)}--leading\"\n              class=\"ActionListItem-visual ActionListItem-visual--leading\"\n            >\n              ${this.getLeadingVisual(icon, avatar)}\n            </span>`\n          : null}\n        <span class=\"${inlineDescription ? 'ActionListItem-descriptionWrap-inline' : 'ActionListItem-descriptionWrap'}\">\n          <span class=\"ActionListItem-label text-normal\">${valueToShow}</span>\n          ${description ? html`<span class=\"ActionListItem-description\">${description}</span>` : null}\n        </span>\n\n        ${this.#searchItems.size > 0\n          ? html`<span aria-hidden=\"true\" class=\"ActionListItem-description QueryBuilder-ListItem-trailing\"\n              >${AutocompleteText}</span\n            >`\n          : html``}\n      </span>\n    </li>`\n  }\n\n  /*\n   * The updateScreenReaderFeedback function is used to update the screen reader feedback.\n   * It dispatchs a custom event so any addEventListener with the same key will be able to\n   * update the screen reader feedback with a new i18n text.\n   */\n  updateScreenReaderFeedback(inputString: string): void {\n    const event = new FeedbackEvent('NEW_RESULTS', inputString, {})\n    this.dispatchEvent(event)\n    this.screenReaderFeedback.textContent = event.text\n  }\n\n  async clear() {\n    await this.parseQuery([])\n    this.#isCleared = true\n  }\n\n  async parseQuery(elements?: QueryElement[], focusOnInput = true) {\n    this.#parseAbortController?.abort()\n    const {signal} = (this.#parseAbortController = new AbortController())\n\n    if (!elements) {\n      elements = this.parseInputValue()\n    } else {\n      const newInputValue = elements\n        .map(item => {\n          if (item.type === 'filter') return `${item.filter}:${item.value}`\n          return item.value\n        })\n        // Don't assume separator if a custom parser is specified\n        .join(this.#usingCustomParser ? '' : ' ')\n\n      // When using in react, we need to update the prototype value so the dispatched `change` event does not get\n      // discarded\n      const prototypeValueSetter = Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.input), 'value')?.set\n\n      if (prototypeValueSetter) {\n        prototypeValueSetter?.call(this.input, newInputValue)\n      } else {\n        this.input.value = newInputValue\n      }\n\n      this.input.dispatchEvent(new Event('change', {bubbles: true}))\n    }\n\n    this.lastParsedQuery = this.input.value\n\n    await new Promise(resolve => requestAnimationFrame(resolve))\n\n    if (signal.aborted) return\n    this.styleInputText(elements)\n    if (focusOnInput) this.input.focus()\n\n    await new Promise(resolve => setTimeout(resolve, 100))\n    if (signal.aborted) return\n\n    for (const provider of this.#searchItems.keys()) {\n      this.#searchItemsMarkedForClearing.add(provider)\n    }\n\n    this.#filterItems.clear()\n    this.#filters.clear()\n\n    const event = new QueryEvent(elements, this.input.value, this.parsedMetadata)\n    this.dispatchEvent(event)\n\n    // The sync effects of the QueryEvent should all have triggered by now,\n    // meaning that any providers which did not clear their own search items\n    // (or indicate they were fetching data) should have their data cleared for\n    // them.\n    let shouldRequestUpdate = false\n    for (const provider of this.#searchItemsMarkedForClearing.keys()) {\n      this.#searchItems.delete(provider)\n      this.#searchItemsMarkedForClearing.delete(provider)\n      shouldRequestUpdate = true\n    }\n    if (shouldRequestUpdate) {\n      this.#requestUpdate()\n    }\n\n    this.updateVisibility()\n  }\n\n  // Parses the input value\n  #defaultParser(inputValue: string): QueryElement[] {\n    const cachedElements = this.#inputCache.get(inputValue)\n    if (cachedElements) {\n      return cachedElements.slice()\n    } else {\n      const elements: QueryElement[] = []\n      const queries = inputValue.split(/\\s(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/g)\n      for (const query of queries) {\n        const filterKeyIndex = query.indexOf(this.filterKey)\n\n        if (filterKeyIndex > 0) {\n          const filter = query.substring(0, filterKeyIndex)\n          const value = query.substring(filterKeyIndex + 1)\n          elements.push(this.#filterNames.has(filter) ? {type: 'filter', filter, value} : {type: 'text', value: query})\n        } else {\n          elements.push({type: 'text', value: query})\n        }\n      }\n      this.#inputCache.set(inputValue, [...elements])\n      return elements\n    }\n  }\n\n  styleInputText(elements: QueryElement[]) {\n    this.#setSizer(this.input.value)\n    const fragment = document.createDocumentFragment()\n    for (const element of elements) {\n      const queryItem = document.createElement('span')\n      const trailingSpaceElement = document.createElement('span')\n      trailingSpaceElement.textContent = ' '\n\n      // If the user overrides the parser, make no assumption about leading or trailing spaces\n      const shouldAddTrailingSpace = !this.#usingCustomParser\n\n      if (element.type === 'filter') {\n        const {filter, value} = element\n        const filterItem = document.createElement('span')\n\n        queryItem.setAttribute('data-type', 'filter-expression')\n        filterItem.setAttribute('data-type', 'filter')\n        filterItem.textContent = filter\n\n        const filterKey = document.createElement('span')\n        filterKey.textContent = this.filterKey\n\n        const filterValue = document.createElement('span')\n        filterValue.setAttribute('data-type', 'filter-value')\n        filterValue.textContent = value\n\n        queryItem.appendChild(filterItem)\n        queryItem.appendChild(filterKey)\n        queryItem.appendChild(filterValue)\n\n        // Adds the trailing space as a separate element so it isn't included in the styling for the filter value\n        if (shouldAddTrailingSpace) queryItem.appendChild(trailingSpaceElement)\n      } else {\n        if (shouldAddTrailingSpace) {\n          queryItem.textContent = `${element.value} `\n        } else {\n          queryItem.textContent = element.value\n        }\n\n        if (element.style === TextElementStyle.Constant) {\n          queryItem.classList.add('qb-constant')\n        } else if (element.style === TextElementStyle.Entity) {\n          queryItem.classList.add('qb-entity')\n        } else if (element.style === TextElementStyle.FilterValue) {\n          queryItem.classList.add('qb-filter-value')\n        }\n      }\n\n      fragment.append(queryItem)\n      this.#resizeInput()\n    }\n    this.styledInputContent.replaceChildren(fragment)\n  }\n\n  // Gets the width of the input text to help set the visually styled input\n  #setSizer(value: string) {\n    this.sizer.textContent = ''\n\n    if (this.input.selectionStart !== null && this.input.selectionStart === this.input.selectionEnd) {\n      // insert an element where the cursor should be so we can find it\n      const index = this.input.selectionStart\n      const cursor = document.createElement('span')\n\n      this.sizer.append(value.substring(0, index), cursor, value.substring(index))\n    } else {\n      this.sizer.textContent = value\n    }\n  }\n\n  // Determines the size of the input for styling purposes\n  #resizeInput() {\n    const minWidth = 300\n    requestAnimationFrame(() => {\n      const cursor = this.sizer.querySelector('span')\n\n      if (cursor) {\n        // make sure the cursor is visible\n        if (cursor.offsetLeft < this.styledInputContainer.scrollLeft) {\n          this.styledInputContainer.scrollLeft = cursor.offsetLeft - minWidth\n        } else if (cursor.offsetLeft > this.styledInputContainer.scrollLeft + this.styledInputContainer.clientWidth) {\n          this.styledInputContainer.scrollLeft = cursor.offsetLeft - this.styledInputContainer.clientWidth + minWidth\n        }\n      }\n\n      const currentSizerScrollWidth = this.sizer.scrollWidth\n      const newInputWidth = Math.max(currentSizerScrollWidth + 2, this.input.value === '' ? 2 : 0, minWidth)\n\n      this.input.style.width = `${newInputWidth}px`\n    })\n  }\n\n  #providerCount(): number {\n    return Object.keys(this.#providers).length\n  }\n}\nexport * from './query-builder-api'\n"],"names":["policyName","temporaryPermissiveJtmlPolicy","ghTrustedTypes","createPolicy","createHTML","trustedTypesPolicy","apply","policy","s","fallback","fallbackOnError","TemplateResult","setCSPTrustedTypesPolicy","SearchScopeText","AutocompleteText","FilterItem","Event","constructor","filter","value","name","description","inlineDescription","priority","Infinity","icon","avatar","action","isCustomIcon","Object","Octicon","PrefixColor","SearchItem","scope","prefixText","prefixColor","isFallbackSuggestion","TextElementStyle","FetchDataEvent","fetchPromise","QueryEvent","toString","rawQuery","parsedQuery","parsedMetadata","FeedbackEvent","bubbles","cancelable","key","text","data","sortByPriority","a","b","QueryBuilderElement","HTMLElement","input","findTarget","styledInputContent","styledInputContainer","styledInput","overlay","sizer","clearButton","resultsList","screenReaderFeedback","query","i18n","suggestion","suggestions","clear_search","navigate","event","url","target","closest","getAttribute","dispatchEvent","CustomEvent","detail","closed","hasAttribute","hidden","setAttribute","combobox","clearSelection","show","scrollIntoView","behavior","block","hide","initialize","parser","providers","provider","usingCustomParser","canAttachProviders","attachProvider","reduce","rest","detachElementDefinitionReadyForProviders","removeEventListener","elementDefinitionReadyForProviders","connectedCallback","abortController","abort","signal","AbortController","addEventListener","uniqueId","document","readyForRequestProviders","providerCount","requested","Combobox","tabInsertsSuggestions","requestProviders","Promise","resolve","inputCache","Map","elements","parseInputValue","styleInputText","toggleClearButtonVisibility","parse","selectionStart","flatten","type","filterNames","add","filterItemEvent","setProvider","filterItems","get","push","requestUpdate","filters","timeout","setTimeout","fetchDataTimeout","fetchingResults","race","all","fetchDataEvent","currentPromise","error","updateVisibility","searchItemsMarkedForClearing","delete","searchItems","set","searchItemsFetchBuffer","searchItemEvent","has","disconnectedCallback","comboboxCommit","selectedItem","selectedItemType","selectedItemValue","replaceQueryWith","moveCaretTo","parseInt","pop","customEventName","JSON","focus","undefined","newElements","addSelectedItemToFilter","parseQuery","pos","length","setSelectionRange","removeAttribute","valueContainsSpaces","test","filterValues","split","join","inputChange","inputBlur","interactingWithList","classList","remove","focusClass","resultsMousedown","inputFocus","start","initialValue","lastParsedQuery","moveCaretToEndOfInput","hasFocus","contains","inputKeydown","selected","querySelector","link","openInNewWindow","ctrlKey","metaKey","window","open","click","inputSubmit","clearButtonFocus","previousFocusTarget","relatedTarget","clearButtonBlur","size","getLeadingVisual","classes","html","iconElement","getElementById","innerHTML","updateScreenReaderFeedback","inputString","textContent","clear","isCleared","focusOnInput","parseAbortController","newInputValue","map","item","prototypeValueSetter","getOwnPropertyDescriptor","getPrototypeOf","call","requestAnimationFrame","aborted","keys","shouldRequestUpdate","setSizer","fragment","createDocumentFragment","element","queryItem","createElement","trailingSpaceElement","shouldAddTrailingSpace","filterItem","filterKey","filterValue","appendChild","style","Constant","Entity","FilterValue","append","resizeInput","replaceChildren","Set","SCREEN_READER_DELAY","defaultParser","bind","ast","renderSingularItemNames","id","e","stopImmediatePropagation","updateRequested","updateResults","sort","renderFilter","shouldRenderFallbackItems","items","lastItem","at","manuallyDetermineFilterEligibility","renderFilterItem","p","renderSearchItem","screenReaderText","groupsAsHtml","values","renderGroup","filtersAsHtml","renderFilters","render","groupHtml","index","numberOfResults","querySelectorAll","resultText","replace","toLowerCase","ariaLabelAction","singularItemName","ariaLabelDescription","ariaLabel","prefixHTML","styleResults","normalizeValue","commandName","stringify","scopeText","inputArray","out","group","valueToShow","inputValue","cachedElements","slice","queries","filterKeyIndex","indexOf","substring","selectionEnd","cursor","offsetLeft","scrollLeft","clientWidth","currentSizerScrollWidth","scrollWidth","newInputWidth","Math","max","width","attr","controller"],"sourceRoot":""}